# SSHGuard Configuration for Remote Access Protection
# Protects SSH service from brute-force attacks

# Backend for macOS pf firewall
BACKEND="/usr/local/libexec/sshguard/sshg-fw-pf"

# Log source - macOS system log
LOGREADER="STDIN < /var/log/system.log"

# Attack threshold (number of failed attempts)
THRESHOLD=30

# Block duration in seconds (10 minutes)
BLOCK_TIME=600

# Detection time window in seconds (30 minutes)
DETECTION_TIME=1800

# Whitelist file to prevent blocking trusted IPs
WHITELIST_FILE=/usr/local/etc/sshguard.whitelist

# Suspend/resume detection
SUSPEND_MULTIPLIER=1.5
RESUME_MULTIPLIER=1.5

# PID file
PID_FILE=/var/run/sshguard.pid

# Additional protection for SSH (port 2222)
# SSHGuard will monitor for patterns in the log file
# and automatically block IPs that exceed the threshold